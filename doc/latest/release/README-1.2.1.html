<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.20">
<title>AspectJ 1.2.1</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<link rel="stylesheet" href="./asciidoctor.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="./coderay-asciidoctor.css">
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>AspectJ 1.2.1</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_weaver_informational_messages">Weaver Informational Messages</a></li>
<li><a href="#_dump_support">Dump Support</a></li>
<li><a href="#_jdt_compiler_version">JDT Compiler Version</a></li>
<li><a href="#_line_number_information_for_join_points">Line Number Information for Join Points</a></li>
<li><a href="#_runtime_performance">Runtime Performance</a></li>
<li><a href="#_string_concatentation_in_declare_errorwarning_statements">String Concatentation in Declare Error/Warning Statements</a></li>
<li><a href="#_load_time_weaving_support">Load-time Weaving Support</a></li>
<li><a href="#_binary_compatibility">Binary Compatibility</a></li>
<li><a href="#allchanges">All changes are listed in the bug database</a></li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p><em>Â© Copyright 2004 Contributors. All rights reserved.</em></p>
</div>
<div class="paragraph">
<p>AspectJ 1.2.1 is largely a bug-fix release and the definition of the
AspectJ language is unchanged from the 1.2.0 release (with the exception
that AspectJ 1.2.1 permits the use of the '+' operator to concatenate
the messages for declare error and warning statements). This document
describes the tools differences between AspectJ versions 1.2 and 1.2.1.
Users familiar with AspectJ 1.2 may find this document a quicker way to
learn what changed in the tools.</p>
</div>
<div class="paragraph">
<p>This document summarizes changes in:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Weaver messages</p>
</li>
<li>
<p>Dump support</p>
</li>
<li>
<p>JDT Compiler version</p>
</li>
<li>
<p>Line number information for join points</p>
</li>
<li>
<p>Runtime performance</p>
</li>
<li>
<p>String concatentation in declare error and warning statements</p>
</li>
<li>
<p>Load-time weaving support</p>
</li>
<li>
<p>Use of aspect libraries generated by ajc 1.2.1 with earlier versions
of ajc</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See the <a href="changes.html">changes document</a> for more details, or
<a href="#allchanges">all the changes</a> as detailed in the bugzilla database.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_weaver_informational_messages">Weaver Informational Messages</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The AspectJ 1.2.1 compiler can produce informational messages about the
weaving process. To see these messages, use the -showWeaveInfo compiler
option, or set showweaveinfo=true in the iajc ant task.</p>
</div>
<div class="paragraph">
<p>The following is an example of the messages produced when this option is
enabled:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="text">C:\aspectj1.2.1\doc\examples\tjp&gt;ajc -showWeaveInfo *.java

Type 'tjp.Demo' (Demo.java:20) advised by around advice from 'tjp.GetInfo'
(GetInfo.java:26) [RuntimeTest=true]

Type 'tjp.Demo' (Demo.java:30) advised by around advice from 'tjp.GetInfo'
(GetInfo.java:26) [RuntimeTest=true]

Type 'tjp.Demo' (Demo.java:34) advised by around advice from 'tjp.GetInfo'
(GetInfo.java:26) [RuntimeTest=true]</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_dump_support">Dump Support</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In the event of a compiler crash, AspectJ 1.2.1 will produce a dump file
giving important information about the state of the compiler at the time
of the crash. These dump files should enable us to analyze problems more
effectively. In the rare event that you witness a compiler crash, please
attach the dump file to the bug report.</p>
</div>
<div class="paragraph">
<p>In addition to producing a dump file when an abort condition is
detected, the AspectJ 1.2.1 compiler can also be requested to create a
dump file on detection of a compilation error. Set the property
org.aspectj.weaver.Dump.condition=error to enable this behaviour.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_jdt_compiler_version">JDT Compiler Version</h2>
<div class="sectionbody">
<div class="paragraph">
<p>AspectJ 1.2.1 is based on the Eclipse 3.0 final JDT compiler.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_line_number_information_for_join_points">Line Number Information for Join Points</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For source files compiled by ajc (as opposed to binary inputs to the
compiler compiled with some other java compiler), ajc now emits better
line number information for execution join points. In particular, for a
method, constructor or advice execution join point (as matched for
example by a declare error or declare warning statement), ajc 1.2.1
reports the first line number of the declaration, as opposed to the line
number of the first line of code in the body.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_runtime_performance">Runtime Performance</h2>
<div class="sectionbody">
<div class="paragraph">
<p>AspectJ 1.2.1 contains a small number of runtime performance
optimisations, including optimisations of if(true) and if(false)
pointcut expressions, caching of getSignature() and toString() results
on JoinPoint objects, and an optimised implementation of cflow.</p>
</div>
<div class="paragraph">
<p>In the case where there are no arguments bound in the cflow pointcut,
programs compiled under AspectJ 1.2.1 and that make heavy use of cflow
will run significantly faster. Thanks to the abc compiler team for
detecting this performance related bug and for piloting the fix.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_string_concatentation_in_declare_errorwarning_statements">String Concatentation in Declare Error/Warning Statements</h2>
<div class="sectionbody">
<div class="paragraph">
<p>String concatentation in declare error and warning statements is now
supported. For example, you can write:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">declare warning : jdbcCall() &amp;&amp; !inDataLayer()
                : <span class="string"><span class="delimiter">&quot;</span><span class="content">Please don't make calls to JDBC </span><span class="delimiter">&quot;</span></span> +
                  <span class="string"><span class="delimiter">&quot;</span><span class="content">outside of the data layer.</span><span class="delimiter">&quot;</span></span>;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_load_time_weaving_support">Load-time Weaving Support</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The AspectJ 1.2.1 distribution contains a new jar in the lib directory,
aspectjweaver.jar, that contains the subset of aspectjtools.jar needed
for weaving only. This jar may be used in situations where you wish to
exploit AspectJ&#8217;s binary weaving capabilities, but do not want the full
aspectjtools.jar around (aspectjweaver.jar is approx. 5 times smaller).</p>
</div>
<div class="paragraph">
<p>In addition, the load-time weaving "aj" script which was included in the
doc/examples/ltw directory in the 1.2 distribution has been moved into
the regular bin directory. See <a href="README-1.2.html">README-1.2</a> for
details of using this script.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_binary_compatibility">Binary Compatibility</h2>
<div class="sectionbody">
<div class="paragraph">
<p>AspectJ 1.2.1 introduces a backwards-incompatible change to the class
file format generated by the AspectJ compiler. Classes generated by ajc
v1.2.1 cannot be used on the inpath or aspectpath of a weaver from a
prior version of the compiler. Classes generated by prior versions of
the compiler can of course be placed on the inpath or aspectpath of the
1.2.1 weaver.</p>
</div>
<div class="paragraph">
<p>As ever, you should use the AspectJ runtime library (aspectjrt.jar) that
comes with the distribution you used to build your application.</p>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="allchanges">All changes are listed in the bug database</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For a complete list of changes in the 1.2.1 release, search for
<code>target 1.2.1</code> in the bug database:
<a href="https://bugs.eclipse.org/bugs/buglist.cgi?product=AspectJ&amp;component=Compiler&amp;target_milestone=1.2.1">https://bugs.eclipse.org/bugs/buglist.cgi?product=AspectJ&amp;target_milestone=1.2.1&amp;bug_status=RESOLVED&amp;resolution=FIXED</a></p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2024-02-01 14:58:10 +0700
</div>
</div>
</body>
</html>